<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <style>
        .vote-section .vote-btn {
            background: #f8f9fa !important;
            border: 2px solid #dee2e6 !important;
            padding: 8px 12px !important;
            cursor: pointer !important;
            border-radius: 6px !important;
            transition: all 0.3s ease !important;
            font-size: 16px !important;
            margin: 0 5px !important;
            color: #333 !important;
        }

        .vote-section .vote-btn:hover {
            background: #e9ecef !important;
            transform: scale(1.05) !important;
        }

        .vote-section .vote-btn.active-upvote {
            background: #4CAF50 !important;
            color: white !important;
            border-color: #4CAF50 !important;
            box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3) !important;
        }

        .vote-section .vote-btn.active-downvote {
            background: #f44336 !important;
            color: white !important;
            border-color: #f44336 !important;
            box-shadow: 0 2px 4px rgba(244, 67, 54, 0.3) !important;
        }

        .vote-section .vote-btn.active-upvote:hover {
            background: #45a049 !important;
        }

        .vote-section .vote-btn.active-downvote:hover {
            background: #da190b !important;
        }
    </style>
</head>
<body>

<th:block th:fragment="perk-list">
    <div class="perks-grid" th:if="${perks != null and !perks.isEmpty()}">
        <div class="perk-card" th:each="perk : ${perks}" th:id="'perk-' + ${perk.id}">
            <div class="perk-header">
                <h3 class="perk-title" th:text="${perk.title}">Perk Title</h3>
                <span class="perk-membership" th:text="${perk.membershipType.name}">Membership</span>
            </div>
            <p class="perk-description" th:text="${perk.description}">Perk description goes here</p>
            <div class="perk-info">
                <span>üìç <span th:text="${perk.region}">Region</span></span>
                <span>üìÖ Expires: <span th:text="${#temporals.format(perk.expiryDate, 'MMM dd, yyyy')}">Date</span></span>
            </div>
            <div class="perk-footer" th:id="'perk-footer-' + ${perk.id}">
                <div class="vote-section">
                    <button class="vote-btn"
                            th:class="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == true} ?
                                     'vote-btn active-upvote' : 'vote-btn'"
                            th:style="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == true} ?
                                     'background: #4CAF50; color: white; border-color: #4CAF50;' : ''"
                            hx-post="/perks/${perk.id}/upvote-fragment"
                            th:hx-post="@{/perks/{id}/upvote-fragment(id=${perk.id})}"
                            hx-target="#perk-footer-${perk.id}"
                            th:hx-target="'#perk-footer-' + ${perk.id}"
                            hx-swap="outerHTML">üëç</button>
                    <span class="votes-count" th:text="${perk.votes} + ' votes'">0 votes</span>
                    <button class="vote-btn"
                            th:class="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == false} ?
                                     'vote-btn active-downvote' : 'vote-btn'"
                            th:style="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == false} ?
                                     'background: #f44336; color: white; border-color: #f44336;' : ''"
                            hx-post="/perks/${perk.id}/downvote-fragment"
                            th:hx-post="@{/perks/{id}/downvote-fragment(id=${perk.id})}"
                            hx-target="#perk-footer-${perk.id}"
                            th:hx-target="'#perk-footer-' + ${perk.id}"
                            hx-swap="outerHTML">üëé</button>
                </div>
                <small style="color: #999;">by <span th:text="${perk.createdBy.username}">User</span></small>
            </div>
        </div>
    </div>

    <div class="no-perks" th:if="${perks == null or perks.isEmpty()}">
        <h2>No perks found</h2>
        <p>Be the first to create one!</p>
        <button th:if="${isLoggedIn}"
                hx-get="/perks/new"
                hx-target="#modal-content"
                hx-swap="innerHTML"
                onclick="document.getElementById('modal').classList.add('show')"
                class="btn btn-primary"
                style="margin-top: 20px;">Create Perk</button>
    </div>
</th:block>

<th:block th:fragment="vote-section">
    <div class="perk-footer" th:id="'perk-footer-' + ${perk.id}">
        <div class="vote-section">
            <button class="vote-btn"
                    th:class="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == true} ?
                             'vote-btn active-upvote' : 'vote-btn'"
                    th:style="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == true} ?
                             'background: #4CAF50; color: white; border-color: #4CAF50;' : ''"
                    hx-post="/perks/${perk.id}/upvote-fragment"
                    th:hx-post="@{/perks/{id}/upvote-fragment(id=${perk.id})}"
                    hx-target="#perk-footer-${perk.id}"
                    th:hx-target="'#perk-footer-' + ${perk.id}"
                    hx-swap="outerHTML">üëç</button>
            <span class="votes-count" th:text="${perk.votes} + ' votes'">0 votes</span>
            <button class="vote-btn"
                    th:class="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == false} ?
                             'vote-btn active-downvote' : 'vote-btn'"
                    th:style="${votedPerks != null and votedPerks.containsKey(perk.id) and votedPerks.get(perk.id) == false} ?
                             'background: #f44336; color: white; border-color: #f44336;' : ''"
                    hx-post="/perks/${perk.id}/downvote-fragment"
                    th:hx-post="@{/perks/{id}/downvote-fragment(id=${perk.id})}"
                    hx-target="#perk-footer-${perk.id}"
                    th:hx-target="'#perk-footer-' + ${perk.id}"
                    hx-swap="outerHTML">üëé</button>
        </div>
        <small style="color: #999;">by <span th:text="${perk.createdBy.username}">User</span></small>
    </div>
</th:block>

</body>
</html>